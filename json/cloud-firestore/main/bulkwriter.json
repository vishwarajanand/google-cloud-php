{"id":"firestore\/bulkwriter","type":"","title":"Google\\Cloud\\Firestore\\BulkWriter","name":"BulkWriter","description":"<p>Enqueue and write multiple mutations to Cloud Firestore.<\/p>\n<p>This class may be used directly for multiple non-transactional writes with\nautomatic retry on failure. To run changes in a transaction (with automatic\nretry\/rollback on failure), use <a data-custom-type=\"cloud-firestore\/main\/firestore\/transaction\">Google\\Cloud\\Firestore\\Transaction<\/a>.\nSingle modifications can be made using the various methods on\n<a data-custom-type=\"cloud-firestore\/main\/firestore\/documentreference\">Google\\Cloud\\Firestore\\DocumentReference<\/a>.<\/p>","examples":[{"caption":"","code":"use Google\\Cloud\\Firestore\\FirestoreClient;\n\n$firestore = new FirestoreClient();\n$batch = $firestore->bulkWriter();"}],"resources":[],"methods":[{"id":"__construct","type":"constructor","name":"__construct","source":"Firestore\/src\/BulkWriter.php#L238","description":"","examples":[],"resources":[],"params":[{"name":"connection","description":"<p>A connection to Cloud Firestore<\/p>","types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/connection\/connectioninterface\">Google\\Cloud\\Firestore\\Connection\\ConnectionInterface<\/a>"],"optional":false,"nullable":null},{"name":"valueMapper","description":"<p>A Value Mapper instance<\/p>","types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/valuemapper\">Google\\Cloud\\Firestore\\ValueMapper<\/a>"],"optional":false,"nullable":null},{"name":"database","description":"<p>The current database<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration options is an array.<\/p>\n<pre><code>Please note that the default values are experiementally derived after\nperformance evaluations. The underlying constants may change in backwards-\nincompatible ways. Please use with caution, and test thoroughly when\nupgrading.\n\nFor legacy reasons if provided as `string` or `null`, its assumed\nto be transaction id for Google\\Cloud\\Firestore\\WriteBatch.<\/code><\/pre>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":true,"nullable":null},{"name":"options.maxBatchSize","description":"<p>Maximum number of requests per BulkWriter batch. <strong>Defaults to<\/strong> <code>20<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"options.greedilySend","description":"<p>Flag to indicate whether BulkWriter greedily sends batches. <strong>Defaults to<\/strong> <code>true<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.boolean.php\" target=\"_blank\">bool<\/a>"],"optional":null,"nullable":null},{"name":"options.isThrottlingEnabled","description":"<p>Flag to indicate whether rate of sending writes can be throttled. <strong>Defaults to<\/strong> <code>true<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.boolean.php\" target=\"_blank\">bool<\/a>"],"optional":null,"nullable":null},{"name":"options.initialOpsPerSecond","description":"<p>Initial number of operations per second. <strong>Defaults to<\/strong> <code>20<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"options.maxOpsPerSecond","description":"<p>Maximum number of operations per second. <strong>Defaults to<\/strong> <code>500<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.integer.php\" target=\"_blank\">int<\/a>"],"optional":null,"nullable":null},{"name":"options.isRetryable","description":"<p>Default retry handler for individial writes status code to be retried. Should accept error code and return true if retryable.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.callable.php\" target=\"_blank\">callable<\/a>"],"optional":null,"nullable":null}],"exceptions":[],"returns":[]},{"id":"create","type":"instance","name":"create","source":"Firestore\/src\/BulkWriter.php#L344","description":"<p>Enqueue a document creation.<\/p>\n<p>This operation will fail (when committed) if the document already exists.<\/p>","examples":[{"caption":"","code":"$batch->create($documentName, [\n    'name' => 'John'\n]);"}],"resources":[],"params":[{"name":"document","description":"<p>The document to target, either\nas a string document name, or DocumentReference object. Please\nnote that DocumentReferences will be used only for the document\nname. Field data must be provided in the <code>$fields<\/code> argument.<\/p>","types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/documentreference\">Google\\Cloud\\Firestore\\DocumentReference<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"fields","description":"<p>An array containing fields, where keys are the field\nnames, and values are field values. Nested arrays are allowed.\nNote that unlike <a data-custom-type=\"cloud-firestore\/main\/firestore\/documentreference\" data-method=\"update\">Google\\Cloud\\Firestore\\DocumentReference::update()<\/a>,\nfield paths are NOT supported by this method.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration options<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null}],"exceptions":[{"type":"\\InvalidArgumentException","description":"If `FieldValue::deleteField()` is found in the fields list."},{"type":"\\InvalidArgumentException","description":"If `FieldValue::serverTimestamp()` is found in an array value."}],"returns":[{"types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/bulkwriter\">Google\\Cloud\\Firestore\\BulkWriter<\/a>"],"description":""}]},{"id":"set","type":"instance","name":"set","source":"Firestore\/src\/BulkWriter.php#L415","description":"<p>Enqueue a set mutation.<\/p>\n<p>Unless <code>$options['merge']<\/code> is set to `true, this method replaces all\nfields in a Firestore document.<\/p>","examples":[{"caption":"","code":"$batch->set($documentName, [\n    'name' => 'John'\n]);"}],"resources":[],"params":[{"name":"document","description":"<p>The document to target, either\nas a string document name, or DocumentReference object. Please\nnote that DocumentReferences will be used only for the document\nname. Field data must be provided in the <code>$fields<\/code> argument.<\/p>","types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/documentreference\">Google\\Cloud\\Firestore\\DocumentReference<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"fields","description":"<p>An array containing fields, where keys are the field\nnames, and values are field values. Nested arrays are allowed.\nNote that unlike <a data-custom-type=\"cloud-firestore\/main\/firestore\/bulkwriter\" data-method=\"update\">Google\\Cloud\\Firestore\\BulkWriter::update()<\/a>,\nfield paths are NOT supported by this method.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration Options<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null},{"name":"options.merge","description":"<p>If true, unwritten fields will be preserved. Otherwise, they will be overwritten (removed). <strong>Defaults to<\/strong> <code>false<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.boolean.php\" target=\"_blank\">bool<\/a>"],"optional":null,"nullable":null}],"exceptions":[{"type":"\\InvalidArgumentException","description":"If `FieldValue::deleteField()` is found in the document when `$options.merge`\nis not `true`."},{"type":"\\InvalidArgumentException","description":"If `FieldValue::serverTimestamp()` is found in an array value."}],"returns":[{"types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/bulkwriter\">Google\\Cloud\\Firestore\\BulkWriter<\/a>"],"description":""}]},{"id":"update","type":"instance","name":"update","source":"Firestore\/src\/BulkWriter.php#L528","description":"<p>Enqueue an update with field paths and values.<\/p>\n<p>Merges provided data with data stored in Firestore.<\/p>\n<p>Calling this method on a non-existent document will raise an exception.<\/p>\n<p>This method supports various sentinel values, to perform special operations\non fields. Available sentinel values are provided as methods, found in\n<a data-custom-type=\"cloud-firestore\/main\/firestore\/fieldvalue\">Google\\Cloud\\Firestore\\FieldValue<\/a>.<\/p>\n<p>Note that field names must be provided using field paths, encoded either\nas a dot-delimited string (i.e. <code>foo.bar<\/code>), or an instance of\n<a data-custom-type=\"cloud-firestore\/main\/firestore\/fieldpath\">Google\\Cloud\\Firestore\\FieldPath<\/a>. Nested arrays are not allowed.<\/p>\n<p>Please note that conflicting paths will result in an exception. Paths\nconflict when one path indicates a location nested within another path.\nFor instance, path <code>a.b<\/code> cannot be set directly if path <code>a<\/code> is also\nprovided.<\/p>","examples":[{"caption":"","code":"$batch->update($documentName, [\n    ['path' => 'name', 'value' => 'John'],\n    ['path' => 'country', 'value' => 'USA'],\n    ['path' => 'cryptoCurrencies.bitcoin', 'value' => 0.5],\n    ['path' => 'cryptoCurrencies.ethereum', 'value' => 10],\n    ['path' => 'cryptoCurrencies.litecoin', 'value' => 5.51]\n]);"},{"caption":"<p>Google Cloud PHP provides special field values to enable operations such as deleting fields or setting the value to the current server timestamp.<\/p>","code":"use Google\\Cloud\\Firestore\\FieldValue;\n\n$batch->update($documentName, [\n    ['path' => 'country', 'value' => FieldValue::deleteField()],\n    ['path' => 'lastLogin', 'value' => FieldValue::serverTimestamp()]\n]);"},{"caption":"<p>If your field names contain special characters (such as <code>.<\/code>, or symbols), using <a data-custom-type=\"cloud-firestore\/main\/firestore\/fieldpath\">Google\\Cloud\\Firestore\\FieldPath<\/a> will properly escape each element.<\/p>","code":"use Google\\Cloud\\Firestore\\FieldPath;\n\n$batch->update($documentName, [\n    ['path' => new FieldPath(['cryptoCurrencies', 'big$$$coin']), 'value' => 5.51]\n]);"}],"resources":[],"params":[{"name":"document","description":"<p>The document to target, either\nas a string document name, or DocumentReference object. Please\nnote that DocumentReferences will be used only for the document\nname. Field data must be provided in the <code>$data<\/code> argument.<\/p>","types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/documentreference\">Google\\Cloud\\Firestore\\DocumentReference<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"data","description":"<p>A list of arrays of form\n<code>[FieldPath|string $path, mixed $value]<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array[]<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration options<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null}],"exceptions":[{"type":"\\InvalidArgumentException","description":"If data is given in an invalid format\nor is empty."},{"type":"\\InvalidArgumentException","description":"If any field paths are empty."},{"type":"\\InvalidArgumentException","description":"If field paths conflict."}],"returns":[{"types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/bulkwriter\">Google\\Cloud\\Firestore\\BulkWriter<\/a>"],"description":""}]},{"id":"delete","type":"instance","name":"delete","source":"Firestore\/src\/BulkWriter.php#L631","description":"<p>Delete a Firestore document.<\/p>","examples":[{"caption":"","code":"$batch->delete($documentName);"}],"resources":[],"params":[{"name":"document","description":"<p>The document to target, either\nas a string document name, or DocumentReference object.<\/p>","types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/documentreference\">Google\\Cloud\\Firestore\\DocumentReference<\/a>","<a href=\"http:\/\/php.net\/manual\/en\/language.types.string.php\" target=\"_blank\">string<\/a>"],"optional":false,"nullable":null},{"name":"options","description":"<p>Configuration Options<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a data-custom-type=\"cloud-firestore\/main\/firestore\/bulkwriter\">Google\\Cloud\\Firestore\\BulkWriter<\/a>"],"description":""}]},{"id":"flush","type":"instance","name":"flush","source":"Firestore\/src\/BulkWriter.php#L657","description":"<p>Flushes the enqueued writes in batches with auto-retries. Please note:<\/p>\n<ul>\n<li>This method is blocking and may execute many sequential batch write requests.<\/li>\n<\/ul>\n<ul>\n<li>Gradually ramps up writes as specified by the 500\/50\/5 rule.\n<ul>\n<li>Does not guarantee the order of writes.<\/li>\n<li>Accepts unique document references only.\nRead more: <a href=\"https:\/\/cloud.google.com\/firestore\/docs\/best-practices#ramping_up_traffic\">Ramping up traffic<\/a><\/li>\n<\/ul><\/li>\n<\/ul>","examples":[{"caption":"","code":"$batch->flush();"}],"resources":[],"params":[{"name":"waitForRetryableFailures","description":"<p>Flag to indicate whether to wait for\nretryable failures. <strong>Defaults to<\/strong> <code>false<\/code>.<\/p>","types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.boolean.php\" target=\"_blank\">bool<\/a>"],"optional":false,"nullable":null}],"exceptions":[],"returns":[{"types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"description":"<p><a href=\"BatchWriteResponse\">https:\/\/firebase.google.com\/docs\/firestore\/reference\/rpc\/google.firestore.v1beta1#BatchWriteResponse<\/a><\/p>"}]},{"id":"close","type":"instance","name":"close","source":"Firestore\/src\/BulkWriter.php#L778","description":"<p>Close the bulk writer instance for further writes.<\/p>\n<p>Also, flushes all retries and pending writes.<\/p>","examples":[],"resources":[],"params":[],"exceptions":[],"returns":[{"types":["<a href=\"http:\/\/php.net\/manual\/en\/language.types.array.php\" target=\"_blank\">array<\/a>"],"description":"<p><a href=\"BatchWriteResponse\">https:\/\/firebase.google.com\/docs\/firestore\/reference\/rpc\/google.firestore.v1beta1#BatchWriteResponse<\/a><\/p>"}]}]}